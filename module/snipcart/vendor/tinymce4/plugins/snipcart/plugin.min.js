function rgb2hex(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}!function(){!function(){"use strict";function a(){}return tinymce.PluginManager.add("snipcart",function(a,b){function c(){$.get("./site/data/snipcart/module/datadefault.json",function(b){function c(a,b,c){var d="",e=a.indexOf(b);if(-1!=e){e+=b.length;var f=a.indexOf(c,e);d=a.substr(e,f-e)}return d}var d=!1,e="",f="",g=b.taxes,h="",i="",j="",k="",l="",m=b.poids,n=b.transport,o="",p="",q="",r="",s="",t="",u="",v=b.buttonText,w=b.buttonWidth,x=rgb2hex(b.buttonColor),y=rgb2hex(b.buttonBgColor),z=b.template,A="",B="bouton_produit_ligne";if("bouton_produit"===z&&("col6"===a.selection.getNode().parentElement.className||"col4"===a.selection.getNode().parentElement.className)&&(B="bouton_produit_colonne"),"BUTTON"===a.selection.getNode().nodeName&&"snipcart-add-item"===a.selection.getNode().className){e=a.selection.getNode().parentElement.innerHTML,g=c(e,'data-item-taxes="','"'),h=c(e,'data-item-id="','"'),i=c(e,'data-item-price="','"'),j=c(e,'data-item-description="','"'),k=c(e,'data-item-image="','"'),l=c(e,'data-item-name="','"'),m=c(e,'data-item-weight="','"'),o=c(e,'data-item-custom1-name="','"'),p=c(e,'data-item-custom1-options="','"'),q=c(e,'data-item-custom2-name="','"'),r=c(e,'data-item-custom2-options="','"'),s=c(e,'data-item-custom3-name="','"'),t=c(e,'data-item-custom4-name="','"'),u=c(e,'data-item-custom4-value="','"'),v=c(e,'px;">',"<"),w=c(e,"width: ","p"),x=c(e,'style="color:',";"),y=c(e,"background-color:",";");var C=c(e,'data-item-shippable="','"');n="true"===C?!0:!1,f=c(e,'textFree"',"style="),A=e.includes('data-template-button="')?c(e,'data-template-button="','"'):"bouton_seul",d=!0}var D="",E="X";"bouton_seul"===A?(D="Cr\xe9ation d'un bouton d'ajout au panier Snipcart",E="X",d&&(D="Modification du bouton d'ajout au panier Snipcart",E="Supprimer")):(D="Cr\xe9ation d'un produit Snipcart",d&&(D="Modification du produit Snipcart",E="Supprimer"));var F=[{title:"G\xe9n\xe9ral",type:"form",items:[{type:"textbox",name:"name",label:"Nom du produit",value:l},{type:"textbox",name:"id",label:"Id du produit",value:h},{type:"textbox",name:"description",label:"Description",multiline:!0,minWidth:400,minHeight:100,value:j},{type:"filepicker",filetype:"image",name:"image",label:"Illustration",value:k},{type:"textbox",name:"tarif",label:"Tarif TTC",value:i},{type:"textbox",name:"poids",label:"Poids en grammes",value:m},{type:"textbox",name:"taxe",label:"Taxe",value:g},{type:"checkbox",name:"shippable",text:"Frais de transport",label:"Transport",checked:n}]},{title:"Bouton",type:"form",items:[{type:"textbox",name:"textButton",label:"Texte du bouton",value:v},{type:"textbox",name:"widthButton",label:"Largeur du bouton",value:w},{type:"colorpicker",name:"colorButton",label:"Couleur du texte",value:x},{type:"colorpicker",name:"colorBgButton",label:"Couleur du bouton",value:y}]},{title:"Options",type:"form",items:[{type:"container",name:"container",label:"",html:'<p><a href="https://docs.snipcart.com/v3/setup/products" target="_blank">Documentation Snipcart</a></p>\n							<p>&nbsp;</p>\n							<p>Pour permettre au client de choisir une option avec une liste d\xe9roulante</p>\n							<p>Voir "Custom Fields"  et "1.Droptown", ne pas saisir les guillemets double (")</p>'},{type:"textbox",name:"advancedName1",label:"data-item-custom1-name",value:o},{type:"textbox",name:"advancedOptions1",label:"data-item-custom1-options",value:p},{type:"container",name:"container",label:"",html:"<p>&nbsp;</p><p>Pour permettre au client de choisir une seconde option</p>"},{type:"textbox",name:"advancedName2",label:"data-item-custom2-name",value:q},{type:"textbox",name:"advancedOptions2",label:"data-item-custom2-options",value:r}]},{title:"Textes",type:"form",items:[{type:"container",name:"container",label:"",html:'<p><a href="https://docs.snipcart.com/v3/setup/products" target="_blank">Documentation Snipcart</a></p>\n							<p>&nbsp;</p>\n							<p>Pour permettre au client d\'ins\xe9rer un texte</p>\n							<p>Voir "Custom Fields"  et "4.Texarea", ne pas saisir les guillemets double (")</p>'},{type:"textbox",name:"advancedName3",label:"data-item-custom3-name",value:s},{type:"container",name:"container",label:"",html:'<p>&nbsp;</p><p>Pour vous permettre d\'afficher un texte</p>\n							<p>Voir "Custom Fields"  et "5.Readonly", ne pas saisir les guillemets double (")</p>'},{type:"textbox",name:"advancedName4",label:"data-item-custom4-name",value:t},{type:"textbox",name:"advancedValue4",label:"data-item-custom4-value",value:u}]},{title:"Avanc\xe9",type:"form",items:[{type:"container",name:"container",label:"",html:'<p><a href="https://docs.snipcart.com/v3/setup/products" target="_blank">Documentation Snipcart</a></p>\n							<p>&nbsp;</p>\n							<p>Vous pouvez saisir des attributs "data-..." et leur valeur, exemple :</p>\n							<p><font face="Arial"><em> data-item-custom5-name="Cadeau" data-item-custom5-type="checkbox" </em></font></p>\n							<p><a href="site/data/snipcart/module/interdits.html" target="_blank">ATTENTION Consultez la liste des attributs interdits !</a></p>'},{type:"textbox",name:"textCustomFree",label:"",multiline:!0,minWidth:400,minHeight:100,value:f}]}];a.windowManager.open({title:D,bodyType:"tabpanel",body:F,onsubmit:function(b){b.data.name=b.data.name.replace(/"/g,""),b.data.id=b.data.id.replace(/"/g,""),b.data.description=b.data.description.replace(/"/g,""),b.data.tarif=b.data.tarif.replace(/"/g,""),b.data.poids=b.data.poids.replace(/"/g,""),b.data.taxe=b.data.taxe.replace(/"/g,""),b.data.textButton=b.data.textButton.replace(/"/g,""),b.data.widthButton=b.data.widthButton.replace(/"/g,""),b.data.advancedName1=b.data.advancedName1.replace(/"/g,""),b.data.advancedName2=b.data.advancedName2.replace(/"/g,""),b.data.advancedName3=b.data.advancedName3.replace(/"/g,""),b.data.advancedName4=b.data.advancedName4.replace(/"/g,""),b.data.advancedOptions1=b.data.advancedOptions1.replace(/"/g,""),b.data.advancedOptions2=b.data.advancedOptions2.replace(/"/g,""),b.data.advancedValue4=b.data.advancedValue4.replace(/"/g,""),-1!=b.data.poids.search(",")&&(b.data.poids=b.data.poids.replace(",",".")),b.data.poids=parseInt(b.data.poids),-1!=b.data.tarif.search(",")&&(b.data.tarif=b.data.tarif.replace(",","."));var c=window.location.href;if(-1!=c.search("page/edit/")&&(c=c.replace("page/edit/","")),-1!=c.search("blog/edit/")){c=c.replace("edit/","");var e=c.lastIndexOf("/");c=c.substr(0,e)}""==b.data.taxe&&(b.data.taxe="NO_TAXE"),""==b.data.name&&(b.data.name="?"),""==b.data.id&&(b.data.id="?"),""==b.data.tarif&&(b.data.tarif="0");var g="";if(""!=b.data.advancedName1&&""!=b.data.advancedOptions1&&(g=' data-item-custom1-name="'+b.data.advancedName1+'" data-item-custom1-options="'+b.data.advancedOptions1+'"'),""!=b.data.advancedName2&&""!=b.data.advancedOptions2&&(g=g+' data-item-custom2-name="'+b.data.advancedName2+'" data-item-custom2-options="'+b.data.advancedOptions2+'"'),""!=b.data.advancedName3&&(g=g+' data-item-custom3-name="'+b.data.advancedName3+'"data-item-custom3-type="textarea"'),""!=b.data.advancedValue4){var h=b.data.advancedValue4.replace(/"/g,"'");g=g+' data-item-custom4-name="'+b.data.advancedName4+'" data-item-custom4-value="'+h+'" data-item-custom4-type="readonly"'}""!=b.data.textCustomFree&&(f=b.data.textCustomFree),d===!1&&(A="bouton_seul","bouton_produit"===z&&(A=B));var i="",j='<p style="text-align: center;"><button class="snipcart-add-item" data-item-id="'+b.data.id+'" data-item-price="'+b.data.tarif+'" data-item-url="'+c+'" data-item-description="'+b.data.description+'" data-item-image="'+b.data.image+'" data-item-name="'+b.data.name+'" data-item-weight="'+b.data.poids+'" data-item-taxes="'+b.data.taxe+'" data-item-has-taxes-included="true" data-item-shippable="'+b.data.shippable+'" data-currency="eur"'+g+'" data-template-button="'+A+'" labelStart="textFree"'+f+'style="color:'+b.data.colorButton+"; background-color:"+b.data.colorBgButton+"; width:"+b.data.widthButton+'px;">'+b.data.textButton+"</button></p>";switch(A){case"bouton_seul":d&&(a.selection.getNode().parentElement.innerHTML=""),i=j;break;case"bouton_produit_ligne":d?(a.selection.getNode().parentElement.parentElement.parentElement.parentElement.parentElement.innerHTML="",i='<div class="block"><h4>'+b.data.name+'</h4><div class="row"><div class="col6"><p><img src="'+b.data.image+'"  /></p></div><div class="col6"><p>'+b.data.description+'</p><p><h3 style="text-align: center;">Prix TTC : '+b.data.tarif+"&euro;</h3></p>"+j+"</div></div></div>"):i='<p>&nbsp;</p><div><div class="block"><h4>'+b.data.name+'</h4><div class="row"><div class="col6"><p><img src="'+b.data.image+'"  /></p></div><div class="col6"><p>'+b.data.description+'</p><p><h3 style="text-align: center;">Prix TTC : '+b.data.tarif+"&euro;</h3></p>"+j+"</div></div></div></div><p>&nbsp;</p>";break;case"bouton_produit_colonne":d?(a.selection.getNode().parentElement.parentElement.parentElement.innerHTML="",i='<div class="block"><h4>'+b.data.name+'</h4><p><img src="'+b.data.image+'"  /></p><p>&nbsp;</p><p>'+b.data.description+'</p><p><h3 style="text-align: center;">Prix TTC : '+b.data.tarif+"&euro;</h3></p>"+j+"</div>"):i='<div><div class="block"><h4>'+b.data.name+'</h4><p><img src="'+b.data.image+'"  /></p><p>&nbsp;</p><p>'+b.data.description+'</p><p><h3 style="text-align: center;">Prix TTC : '+b.data.tarif+"&euro;</h3></p>"+j+"</div></div>";break;default:d&&(a.selection.getNode().parentElement.innerHTML=""),i=j}a.insertContent(i)},buttons:[{text:"Valider",subtype:"primary",onclick:"submit"},{text:"Annuler",onclick:"close"},{text:E,onclick:function(){if(d)switch(A){case"bouton_seul":a.selection.getNode().parentElement.innerHTML="";break;case"bouton_produit_ligne":a.selection.getNode().parentElement.parentElement.parentElement.parentElement.parentElement.innerHTML="";break;case"bouton_produit_colonne":a.selection.getNode().parentElement.parentElement.parentElement.innerHTML="";break;default:a.selection.getNode().parentElement.innerHTML=""}a.windowManager.close()}}]})})}a.addButton("snipcart",{tooltip:"Snipcart",image:b+"/img/snipcart.png",onclick:c}),a.addMenuItem("snipcart",{text:"Snipcart",context:"insert",image:b+"/img/snipcart.png",onclick:c})}),a}()}();